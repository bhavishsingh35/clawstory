{% extends "base.html" %}
{% block title %}Shopping Cart | ClawStory{% endblock %}

{% block content %}
<section class="max-w-6xl mx-auto px-4 py-10">

  <!-- Page Heading -->
  <h1 class="text-3xl font-bold mb-6">Shopping Cart</h1>

  {% if cart_items %}

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

    <!-- ================= CART ITEMS ================= -->
    <div class="lg:col-span-2 space-y-4">

      {% for item in cart_items %}
      <div class="flex gap-4 p-4 border rounded-xl bg-white shadow-sm">

        <!-- Product Image -->
        <img
          src="{{ item.product.image.url }}"
          alt="{{ item.product.name }}"
          class="w-28 h-28 object-contain bg-gray-100 rounded-lg"
        >

        <!-- Product Info -->
        <div class="flex-1">

          <h2 class="font-semibold text-lg text-gray-900">
            {{ item.product.name }}
          </h2>

          <p class="text-gray-600 text-sm mt-1">
            â‚¹{{ item.product.price }} each
          </p>

          <!-- Quantity Update -->
          <form
            method="post"
            action="{% url 'cart:cart_update' item.product.id %}"
            class="flex items-center gap-3 mt-3"
          >
            {% csrf_token %}
            <input
              type="number"
              name="quantity"
              value="{{ item.quantity }}"
              min="1"
              class="w-20 border rounded-md px-2 py-1"
            >
            <button
              type="submit"
              class="text-sm text-blue-600 hover:underline"
            >
              Update
            </button>
          </form>

          <!-- Subtotal -->
          <p class="font-semibold mt-3">
            Subtotal: â‚¹{{ item.subtotal }}
          </p>

          <!-- Remove -->
          <a
            href="{% url 'cart:cart_remove' item.product.id %}"
            class="inline-block text-red-600 text-sm mt-2 hover:underline"
          >
            Remove
          </a>

        </div>
      </div>
      {% endfor %}

    </div>

    <!-- ================= SUMMARY ================= -->
    <aside class="bg-white p-6 rounded-xl shadow-sm h-fit sticky top-24">

      <h2 class="text-xl font-semibold mb-4">
        Order Summary
      </h2>

      <div class="flex justify-between text-gray-700 mb-2">
        <span>Items</span>
        <span>{{ cart_items|length }}</span>
      </div>

      <div class="flex justify-between text-gray-700 mb-2">
        <span>Delivery</span>
        <span class="text-green-600">FREE</span>
      </div>

      <hr class="my-3">

      <div class="flex justify-between text-lg font-bold">
        <span>Total</span>
        <span>â‚¹{{ total }}</span>
      </div>

      <a
        href="{% url 'orders:checkout' %}"
        class="block mt-6 bg-black text-white text-center py-3 rounded-lg font-semibold hover:bg-gray-800 transition"
      >
        Proceed to Checkout
      </a>

      <!-- Trust -->
      <div class="text-sm text-gray-500 mt-4 space-y-1">
        <p>ðŸ”’ Secure payments</p>
        <p>ðŸšš Fast delivery</p>
        <p>ðŸ”„ Easy returns</p>
      </div>

    </aside>

  </div>

  {% else %}

  <!-- EMPTY CART -->
  <div class="text-center py-20">
    <p class="text-gray-600 text-lg mb-6">
      Your cart is empty.
    </p>
    <a
      href="{% url 'pages:shop' %}"
      class="inline-block bg-black text-white px-6 py-3 rounded-lg hover:bg-gray-800 transition"
    >
      Continue Shopping
    </a>
  </div>

  {% endif %}

</section>
{% endblock %}