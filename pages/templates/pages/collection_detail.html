{% extends "base.html" %}

{% block title %}{{ collection.name }} | The Claw Story{% endblock %}

{% block extra_head %}
<meta
  name="description"
  content="Shop {{ collection.name }} collection at The Claw Story. Premium fashion curated for modern style."
/>
{% endblock %}

{% block content %}
<section class="max-w-7xl mx-auto px-4 py-10">

  <!-- COLLECTION HEADER -->
  <header class="mb-8">
    <h1 class="text-3xl font-bold">{{ collection.name }}</h1>
    <p class="text-gray-600 mt-1">
      {{ products.count }} products available
    </p>
  </header>

  {% if products %}
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">

    {% for product in products %}
    <article
      class="border rounded-lg bg-white hover:shadow-lg transition overflow-hidden flex flex-col"
      itemscope
      itemtype="https://schema.org/Product"
    >

      <!-- PRODUCT IMAGE -->
      <a href="{% url 'pages:product_detail' product.slug %}">
        <div class="relative w-full aspect-[3/4] bg-gray-100 overflow-hidden rounded-t-lg">
          {% if product.image %}
          <img
            src="{{ product.image.url }}"
            alt="{{ product.name }}"
            loading="lazy"
            class="absolute inset-0 w-full h-full object-cover transition-transform duration-300 hover:scale-105"
            itemprop="image"
          />
          {% else %}
          <div class="absolute inset-0 flex items-center justify-center text-gray-400 text-sm">
            No image available
          </div>
          {% endif %}
        </div>
      </a>

      <!-- PRODUCT INFO -->
      <div class="p-4 flex flex-col flex-grow">

        <a href="{% url 'pages:product_detail' product.slug %}">
          <h2
            class="font-semibold text-gray-900 hover:underline"
            itemprop="name"
          >
            {{ product.name }}
          </h2>
        </a>

        <p
          class="text-gray-700 mt-1 text-sm font-medium"
          itemprop="offers"
          itemscope
          itemtype="https://schema.org/Offer"
        >
          â‚¹{{ product.price }}
          <meta itemprop="priceCurrency" content="INR">
          <meta itemprop="price" content="{{ product.price }}">
        </p>

        {% if product.stock > 0 %}
          <span class="text-green-600 text-xs mt-1">In stock</span>
        {% else %}
          <span class="text-red-600 text-xs mt-1">Out of stock</span>
        {% endif %}

        <a
          href="{% url 'pages:product_detail' product.slug %}"
          class="mt-auto block text-center bg-gray-900 text-white py-2 rounded-lg text-sm hover:bg-black transition"
        >
          View Product
        </a>

      </div>
    </article>
    {% endfor %}

  </div>
  {% else %}
    <p class="text-gray-500">No products in this collection.</p>
  {% endif %}

</section>
{% endblock %}