{% extends "base.html" %}

{% block title %}{{ product.name }} | Buy Online at Best Price | The ClawStory{% endblock %}

{% block meta_description %}Buy {{ product.name }} online at The ClawStory. Premium quality, best price, fast delivery, and secure checkout across India.{% endblock %}

{% block extra_head %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "@id": "{{ request.scheme }}://{{ request.get_host }}{{ request.path }}#product",
  "name": "{{ product.name|escapejs }}",
  {% if product.image_url %}
  "image": "{{ product.image_url }}",
  {% endif %}
  "description": "{{ product.description|default:''|escapejs }}",
  "url": "{{ request.scheme }}://{{ request.get_host }}{{ request.path }}",
  "offers": {
    "@type": "Offer",
    "priceCurrency": "INR",
    "price": "{{ product.price }}",
    "availability": "{% if product.is_in_stock %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}"
  }
}
</script>
{% endblock %}

{% block content %}
<div class="-mx-4 -my-10 px-4 py-16 bg-[#1a1a1a]">

<section class="max-w-7xl mx-auto" aria-labelledby="product-heading">

  <!-- =====================================================
       BREADCRUMB
  ====================================================== -->
  <nav class="text-sm text-gray-400 mb-8" aria-label="Breadcrumb">
    <a href="{% url 'pages:home' %}" class="hover:underline">Home</a> /
    <a href="{% url 'pages:collection_detail' product.collection.slug %}"
       class="hover:underline">
      {{ product.collection.name }}
    </a> /
    <span class="text-white font-medium">
      {{ product.name }}
    </span>
  </nav>

  <!-- =====================================================
       PRODUCT CARD
  ====================================================== -->
  <div class="bg-white rounded-2xl p-8 md:p-12 shadow-lg">

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">

      <!-- IMAGE -->
      <div class="flex justify-center">
        <div class="w-[320px] sm:w-[380px] md:w-[420px]
                    bg-gray-100 rounded-2xl overflow-hidden">
          {% if product.image_url %}
            <img
              src="{{ product.image_url }}"
              alt="{{ product.name }}"
              width="600"
              height="600"
              loading="lazy"
              class="w-full h-auto object-contain"
            >
          {% else %}
            <div class="flex items-center justify-center h-80 text-gray-400 text-sm">
              No image available
            </div>
          {% endif %}
        </div>
      </div>

      <!-- DETAILS -->
      <div class="space-y-5">

        <h1 id="product-heading"
            class="text-3xl font-extrabold text-gray-900">
          {{ product.name }}
        </h1>

        <p class="text-2xl font-bold text-gray-900">
          â‚¹{{ product.price }}
        </p>

        {% if product.is_in_stock %}
          <p class="text-green-600 font-medium">
            âœ” In Stock ({{ product.stock }} left)
          </p>
        {% else %}
          <p class="text-red-600 font-medium">
            âœ– Out of Stock
          </p>
        {% endif %}

        {% if product.description %}
          <p class="text-gray-700 leading-relaxed">
            {{ product.description }}
          </p>
        {% endif %}

        <!-- =====================================================
             ADD TO CART / BUY NOW
        ====================================================== -->
        {% if product.is_in_stock %}
        <form
          method="post"
          action="{% url 'cart:cart_add' product.id %}"
          class="flex flex-col sm:flex-row gap-4 mt-6"
        >
          {% csrf_token %}

          <div>
            <label for="qty" class="block text-sm font-medium mb-1">
              Quantity
            </label>
            <input
              id="qty"
              type="number"
              name="qty"
              value="1"
              min="1"
              max="{{ product.stock }}"
              required
              class="w-24 border rounded-md px-3 py-2
                     focus:ring-2 focus:ring-[#c7b27c]"
            >
          </div>

          <button
            type="submit"
            name="action"
            value="add"
            class="bg-[#c7b27c] hover:bg-[#bfa764]
                   text-black px-6 py-3 rounded-lg
                   font-semibold transition
                   focus:outline-none focus:ring-2 focus:ring-[#c7b27c]"
          >
            Add to Cart
          </button>

          <button
            type="submit"
            name="action"
            value="buy"
            class="bg-[#111111] hover:bg-black
                   text-white px-6 py-3 rounded-lg
                   font-semibold transition
                   focus:outline-none focus:ring-2 focus:ring-[#111111]"
          >
            Buy Now
          </button>
        </form>
        {% else %}
          <button
            disabled
            class="bg-gray-300 text-gray-600 px-6 py-3 rounded-lg cursor-not-allowed mt-6"
          >
            Currently Unavailable
          </button>
        {% endif %}

        <!-- =====================================================
             TRUST SIGNALS
        ====================================================== -->
        <div class="border-t pt-4 text-sm text-gray-600 space-y-2">
          <p>ðŸšš Free delivery on orders above â‚¹999</p>
          <p>ðŸ”„ 7-day replacement policy</p>
          <p>ðŸ”’ 100% secure payments</p>
          <p>ðŸ“¦ Genuine & quality-checked products</p>
        </div>

      </div>
    </div>
  </div>

</section>
</div>
{% endblock %}
