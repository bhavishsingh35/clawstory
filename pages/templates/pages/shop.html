{% extends "base.html" %}

{% block title %}Shop Online | The ClawStory{% endblock %}

{% block meta_description %}Shop premium clothing online at The ClawStory. Explore curated collections with fast delivery and secure checkout across India.{% endblock %}

{% block content %}
<div class="-mx-4 -my-10 px-4 py-16 bg-[#1a1a1a]">

<section class="max-w-7xl mx-auto" aria-labelledby="shop-heading">

  <!-- =====================================================
       PAGE HEADER
  ====================================================== -->
  <header class="mb-10">
    <h1 id="shop-heading"
        class="text-3xl md:text-4xl font-extrabold text-white mb-2 tracking-wide">
      Shop
    </h1>
    <p class="text-gray-400 text-sm">
      Discover premium clothing curated for everyday style.
    </p>
  </header>

  <!-- =====================================================
       INFO BAR
  ====================================================== -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
    <p class="text-sm text-gray-400">
      {{ products.paginator.count }} products available
    </p>

    <div class="flex gap-2 text-sm text-gray-400">
      <span>Sort:</span>
      <span class="font-medium text-white">Newest</span>
    </div>
  </div>

  <!-- =====================================================
       PRODUCT GRID
  ====================================================== -->
  {% if products %}
  <section
    class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-5"
    aria-label="Product listing"
  >

    {% for product in products %}
    <article
      class="bg-white rounded-xl shadow-sm hover:shadow-lg transition flex flex-col"
      itemscope
      itemtype="https://schema.org/Product"
    >

      <!-- IMAGE -->
      <a
        href="{% url 'pages:product_detail' product.collection.slug product.slug %}"
        aria-label="View {{ product.name }}"
      >
        <div class="relative aspect-square bg-gray-100 overflow-hidden rounded-t-xl">
          {% if product.image_url %}
            <img
              src="{{ product.image_url }}"
              alt="{{ product.name }}"
              loading="lazy"
              width="600"
              height="600"
              class="absolute inset-0 w-full h-full object-cover"
              itemprop="image"
            />
          {% else %}
            <div class="absolute inset-0 flex items-center justify-center text-gray-400 text-sm">
              No Image
            </div>
          {% endif %}
        </div>
      </a>

      <!-- PRODUCT INFO -->
      <div class="p-4 flex flex-col flex-1">

        <p class="text-xs text-gray-500 mb-1">
          {{ product.collection.name }}
        </p>

        <h2
          class="text-sm font-medium leading-snug line-clamp-2 text-gray-900"
          itemprop="name"
        >
          {{ product.name }}
        </h2>

        <!-- PRICE -->
        <p
          class="text-lg font-bold mt-1 text-gray-900"
          itemprop="offers"
          itemscope
          itemtype="https://schema.org/Offer"
        >
          ₹{{ product.price }}
          <meta itemprop="priceCurrency" content="INR">
          <meta itemprop="price" content="{{ product.price }}">
          <meta itemprop="availability"
                content="https://schema.org/{% if product.is_in_stock %}InStock{% else %}OutOfStock{% endif %}">
        </p>

        {% if product.is_in_stock %}
          <p class="text-xs text-green-600 mt-1">
            In stock
          </p>
        {% else %}
          <p class="text-xs text-red-500 mt-1">
            Out of stock
          </p>
        {% endif %}

        <a
          href="{% url 'pages:product_detail' product.collection.slug product.slug %}"
          class="mt-auto block text-center
                 bg-[#111111] text-white
                 py-2 rounded-lg text-sm
                 hover:bg-black transition
                 focus:outline-none focus:ring-2 focus:ring-[#111111]"
        >
          View Product
        </a>

      </div>
    </article>
    {% endfor %}

  </section>

  <!-- =====================================================
       PAGINATION
  ====================================================== -->
  {% if products.paginator.num_pages > 1 %}
  <nav
    class="flex justify-center mt-12 gap-3 text-sm"
    aria-label="Pagination"
  >

    {% if products.has_previous %}
      <a
        href="?{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}page={{ products.previous_page_number }}"
        class="px-4 py-2 bg-white rounded hover:bg-gray-100"
        rel="prev"
      >
        Prev
      </a>
    {% endif %}

    <span class="px-4 py-2 text-gray-400">
      Page {{ products.number }} of {{ products.paginator.num_pages }}
    </span>

    {% if products.has_next %}
      <a
        href="?{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}page={{ products.next_page_number }}"
        class="px-4 py-2 bg-white rounded hover:bg-gray-100"
        rel="next"
      >
        Next
      </a>
    {% endif %}

  </nav>
  {% endif %}

  {% else %}
    <p class="text-gray-400">
      No products found.
    </p>
  {% endif %}

  <!-- =====================================================
       SEO SUPPORTING CONTENT
  ====================================================== -->
  <section class="mt-16 text-sm text-gray-400 leading-relaxed max-w-4xl">
    <p>
      Buy premium men’s clothing online at The ClawStory. Explore curated collections
      including shirts, jackets, pants, and more with fast delivery and secure checkout.
    </p>
  </section>

</section>
</div>
{% endblock %}
